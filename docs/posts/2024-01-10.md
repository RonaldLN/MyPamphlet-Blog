---
draft: false
date: 2024-01-10
authors:
  - ronald_luo
categories:
  - Configure & Debug
comments: true 
---

# åœ¨ VSCode ä¸Šä½¿ç”¨ cmake æ¥æ„å»º C/C++ é¡¹ç›®

ç”±äºå‰å‡ å¤©åœ¨ vscode ä¸Šç¼–å†™å¹¶è¿è¡Œç®€çŸ­çš„ç”¨æ¥æµ‹è¯•(çæ)çš„ python ä»£ç æ—¶æ„Ÿè§‰ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿å’Œå¿«æ·ï¼Œæ‰€ä»¥å¼€å§‹æ‘¸ç´¢åœ¨ vscode ä¸Šæ„å»º C/C++ çš„å°é¡¹ç›®ã€‚ä¹‹å‰éƒ½æ˜¯åœ¨ CLion ä¸Šè¿è¡Œ C/C++ çš„ä»£ç ï¼Œè€Œåœ¨ CLion ä¸Šéƒ½æ˜¯ä½¿ç”¨ cmake æ¥ç®¡ç†é¡¹ç›®ï¼Œæ‰€ä»¥åœ¨ vscode ä¸Šä¹Ÿæƒ³ä½¿ç”¨ cmake æ¥å¼„(å› ä¸ºä¹ æƒ¯äº†)ã€‚

<!-- more -->

## ç›´æ¥ä½¿ç”¨ gcc g++ æ¥ç¼–è¯‘ C/C++ æºæ–‡ä»¶

ä¸€å¼€å§‹å…ˆæ˜¯å»æŸ¥çœ‹äº† vscode å®˜æ–¹æ–‡æ¡£ä¸­ç¼–å†™ C/C++ çš„ç›¸å…³è¯´æ˜

[C++ programming with Visual Studio Code](https://code.visualstudio.com/docs/languages/cpp)

å®‰è£…ä¸Šé¢çš„æŒ‡ç¤ºï¼Œæˆ‘æ–°å»ºäº†æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºäº† `test.cpp` æ–‡ä»¶ï¼Œç„¶ååœ¨å³ä¸Šè§’çš„å›¾æ ‡ä¸­é€‰æ‹©ã€Œè¿è¡Œ C/C++ æ–‡ä»¶ã€ï¼Œ

![vscode_cpp](../images/vscode_cpp.png){ loading=lazy }

ç„¶åä¼šéœ€è¦é€‰æ‹©ç¼–è¯‘å™¨(ç¬¬ä¸€æ¬¡è¿è¡Œæˆ–è€…è°ƒè¯•ï¼Œ**ä¹‹åéƒ½ä¼šé»˜è®¤ä½¿ç”¨**è¿™æ¬¡é€‰çš„ç¼–è¯‘å™¨)ï¼Œc å°±é€‰æ‹© gcc ï¼Œc++ å°±é€‰ g++

![vscode_cpp_2](../images/vscode_cpp_2.png){ loading=lazy }

(ç¬¬ä¸€æ¬¡)è¿è¡Œä¹‹åä¼šç”Ÿæˆ `.vscode` æ–‡ä»¶å¤¹ å’Œ ç¼–è¯‘å‡ºçš„ `exe` ï¼Œ

![vscode_cpp_3](../images/vscode_cpp_3.png){ loading=lazy }

ä½†æ˜¯æˆ‘å¹¶ä¸æ˜¯å¾ˆå–œæ¬¢ç”Ÿæˆçš„ `exe` æ–‡ä»¶å’Œæºæ–‡ä»¶åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹(å¯èƒ½ç»è¿‡ä¸€äº›é…ç½®å¯ä»¥æ›´æ”¹ ç”Ÿæˆ `exe` çš„è·¯å¾„ï¼Œä½†æˆ‘æš‚æ—¶ä¸å¤ªæ¸…æ¥š)ï¼Œäºæ˜¯æˆ‘å°±æƒ³å°è¯•çœ‹çœ‹ vscode ä¸Šèƒ½ä¸èƒ½åƒ CLion ä¸Šä¸€æ ·ï¼Œä½¿ç”¨ cmake æ¥æ„å»ºé¡¹ç›®ï¼Œç„¶å `exe` ä¼šç”Ÿæˆåœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œ

---

æ­¤å¤–ï¼Œæ‘¸ç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°å¦‚æœè¦ç›´æ¥ä½¿ç”¨ gcc g++ æ¥ç¼–è¯‘æºæ–‡ä»¶ï¼Œ

-   è°ƒè¯•å¯¹åº”çš„å¿«æ·é”®æ˜¯ ++f5++
-   è¿è¡Œå¯¹åº”çš„å¿«æ·é”®æ˜¯ ++ctrl+f5++

![vscode_cpp_4](../images/vscode_cpp_4.png){ loading=lazy }

## åœ¨ vscode ä¸Šä½¿ç”¨ cmake

>   ä¸€å¼€å§‹å…ˆæ˜¯åœ¨ç½‘ä¸ŠæŸ¥åˆ°äº†å®˜æ–¹æ–‡æ¡£ä¸­çš„è¿™ä¸ª
>
>   [Get started with CMake Tools on Linux (visualstudio.com)](https://code.visualstudio.com/docs/cpp/cmake-linux)
>
>   ç„¶åçœ‹åˆ°å·¦è¾¹ç›®å½•ä¸Šï¼Œè¿™ä¸€ç¯‡çš„ä¸Šé¢æœ‰ä¸ª [`Build with CMake`](https://code.visualstudio.com/docs/cpp/build-with-cmake) ï¼Œäºæ˜¯ç‚¹è¿›å»çœ‹ï¼Œå‘ç°æ‰“å¼€æ˜¯ä¸ª github ä»“åº“ä¸­çš„ `README.md` æ–‡ä»¶ï¼Œè€Œé‡Œé¢åˆæåˆ°å»ºè®®çœ‹ä¸Šé¢é‚£ä¸ªå®˜æ–¹æ–‡æ¡£é‚£ä¸€ç¯‡ğŸ˜…ï¼Œ
>
>   ä½†æ˜¯çœ‹äº†ä¹‹åï¼Œæ„Ÿè§‰å†™çš„æœ‰ç‚¹å¤æ‚ï¼Œäºæ˜¯è‡ªå·±æ‘¸ç´¢äº†èµ·æ¥

ç»è¿‡æ‘¸ç´¢ï¼Œå‘ç°å¦‚æœé¡¹ç›®æ–‡ä»¶å¤¹ä¸­å·²ç»æœ‰ `CMakeLists.txt` ï¼Œåœ¨æ‰“å¼€è¿™ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨åŠ è½½ cmake çš„æ’ä»¶ï¼Œ

>   ä¹‹åå‘ç°è¿™ä¸€ç‚¹åœ¨å®˜æ–¹æ–‡æ¡£ä¸Šå†™äº†
>
>   [Create a CMake project](https://code.visualstudio.com/docs/cpp/CMake-linux#_create-a-cmake-project)

!!! quote "&nbsp;"

    <big>[Create a CMake project](https://code.visualstudio.com/docs/cpp/CMake-linux#_create-a-cmake-project)</big>
    
    If you have an existing CMake project that already has a `CMakeLists.txt` file in the root directory, you can skip to [Select a kit](https://code.visualstudio.com/docs/cpp/CMake-linux#_select-a-kit) to configure your existing project.

è€Œå¦‚æœæœ¬æ¥æ²¡æœ‰ `CMakeLists.txt` ï¼Œåœ¨æ‰“å¼€é¡¹ç›®åå†æ–°å»º `CMakeLists.txt` ä¹Ÿä¸ä¼šåŠ è½½ cmake ï¼Œæ‰€ä»¥å…³é—­æ–‡ä»¶å¤¹å†é‡æ–°æ‰“å¼€ä¸€ä¸‹å°±å¥½äº†ã€‚

>   ç¨å¾®æä¸€ä¸‹ï¼Œ
>
>   å®˜æ–¹æ–‡æ¡£ä¸Šè¿˜å†™äº†ä¸€ä¸ªåˆ›å»º cmake é¡¹ç›®çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ `Cmake: Quick Start` ï¼š
>
>   -   å…ˆ ++ctrl+shift+p++ ï¼Œæ‰“å¼€å‘½ä»¤è¾“å…¥æ¡†(æˆ–è€…ç”¨å…¶ä»–æ–¹æ³•æ‰“å¼€)
>   -   ç„¶åè¾“å…¥åé€‰æ‹©å¯¹åº”çš„å‘½ä»¤
>
>   ç„¶åä¼šéœ€è¦å†è¾“å…¥/é€‰æ‹©ä¸€äº› é¡¹ç›®åã€é¡¹ç›®ç±»å‹ç­‰ä¹‹ç±»çš„ä¸œè¥¿ï¼Œç„¶åå°±ä¼šåˆ›å»ºä¸€ä¸ª `CMakeList.txt` å’Œ ä¸€ä¸ªè¾“å‡º `Hello xxx` çš„æºæ–‡ä»¶(æ„Ÿè§‰å¾ˆé¸¡è‚‹ğŸ˜…)

æˆ‘ä½¿ç”¨çš„ `CMakeLists.txt` æ˜¯ç›´æ¥ä» CLion ä¸­å¤åˆ¶çš„

=== "C++é¡¹ç›®"

    ```cmake
    cmake_minimum_required(VERSION 3.24)
    project(test)
    
    set(CMAKE_CXX_STANDARD 11)
    
    add_executable(test 
        main.cpp
    )
    ```

=== "Cé¡¹ç›®"

    ```cmake
    cmake_minimum_required(VERSION 3.24)
    project(test)
    
    set(CMAKE_C_STANDARD 11)
    
    add_executable(test
        main.c
    )
    ```

ç„¶åå¦‚æœé¡¹ç›®ä¸­å·²æœ‰ `CMakeLists.txt` æ—¶ï¼Œä¼šè®©é€‰æ‹©è¦ä½¿ç”¨çš„ç¼–è¯‘å™¨ï¼Œäºæ˜¯æˆ‘é€‰æ‹©äº† mingw

![vscode_cmake](../images/vscode_cmake.png){ loading=lazy }

é€‰æ‹©å¥½ä¹‹åï¼Œå°±ä¼šæ„å»º/ç”Ÿæˆé¡¹ç›®ï¼Œ

è€Œä¸”å‘ç°ï¼Œæ¯æ¬¡ä¿®æ”¹å¹¶ä¿å­˜äº† `CMakeLists.txt` æ–‡ä»¶ï¼Œæˆ–è€…åœ¨æ‰“å¼€é¡¹ç›®æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆé¡¹ç›®ï¼Œæˆ–è€…ç‚¹å‡»å·¦ä¸‹è§’çš„ã€Œ:octicons-gear-24:ç”Ÿæˆã€ä¹Ÿå¯ä»¥ç”Ÿæˆé¡¹ç›®

### debug è°ƒè¯• å’Œ run è¿è¡Œ

æˆ‘å…ˆæ˜¯åœ¨å®˜æ–¹æ–‡æ¡£é‚£ä¸€ç¯‡ä¸Šçœ‹åˆ°ï¼Œå¯ä»¥ ++ctrl+shift+p++ ç„¶åå†é€‰æ‹© `Cmake: Debug` å‘½ä»¤æ¥è°ƒè¯•ï¼Œç„¶åå‘ç°è¿™ä¸ªå‘½ä»¤å¯ä»¥ç”¨å¿«æ·é”® ++ctrl+f5++ æ¥è¿è¡Œ

![vscode_cmake_2](../images/vscode_cmake_2.png){ loading=lazy }

ç„¶ååˆå‘ç°ï¼Œè¿è¡Œå¯¹åº”çš„å¿«æ·é”®æ˜¯ ++shift+f5++ (åœ¨ä¸Šå›¾ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°)ï¼Œä»¥åŠä¹‹å‰çš„ ç”Ÿæˆé¡¹ç›® å¿«æ·é”®æ˜¯ ++f7++ (cmake æ’ä»¶ç”Ÿæ•ˆåå±…ç„¶åŒä¸€ä¸ªå¿«æ·é”®æ˜ å°„çš„æ•ˆæœå°±æ”¹å˜äº†(åŸæœ¬ ++ctrl+f5++ æ˜¯ä½¿ç”¨ g++ ç¼–è¯‘å¹¶è¿è¡Œï¼Œç°åœ¨å˜æˆäº† cmake çš„è°ƒè¯•)ï¼Œæ„Ÿè§‰æœ‰ç‚¹ç¥å¥‡)ï¼Œ

äºæ˜¯è¿›è¡Œè¿è¡Œï¼Œå‘ç° `exe` æ–‡ä»¶å°±ç”Ÿæˆåœ¨ `build` æ–‡ä»¶å¤¹ä¸­äº†ã€‚

æ­¤å¤–ï¼Œå·¦ä¸‹è§’çš„ :octicons-bug-24:å›¾æ ‡ å’Œ :material-menu-right-outline:å›¾æ ‡ ä¹Ÿåˆ†åˆ«å¯¹åº” è°ƒè¯• å’Œ è¿è¡Œ

---

### å°ç»“

ä½“éªŒä¸Šï¼Œvscode æ‰“å¼€é¡¹ç›®ç¡®å®å¾ˆå¿«(è™½ç„¶ CLion æ‰“å¼€é€Ÿåº¦å·²ç»ä¸æ…¢äº†ï¼Œä½†æ˜¯æ¯” vscode çš„æ‰“å¼€é€Ÿåº¦è¿˜æ˜¯æ…¢äº›è®¸)ï¼Œæ‰€ä»¥å¯¹äºæˆ‘ä¸´æ—¶èµ·æ„æƒ³è¦æµ‹è¯•çš„ c/c++ ä»£ç å°±ä¼šéå¸¸æ–¹ä¾¿

