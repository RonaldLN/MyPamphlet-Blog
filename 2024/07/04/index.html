<!doctype html><html class=no-js lang=zh><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=../03/ rel=prev><link href=../06/pythonmediapipe/ rel=next><link href=../../../icons/favicon.png rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.4.6" name=generator><title>重新编写视觉模块记录 - My Pamphlet Blog</title><link href=../../../assets/stylesheets/main.35e1ed30.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.356b1318.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../../css/timeago.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-web/style.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel=stylesheet><link href=../../../stylesheets/my_scheme.css rel=stylesheet><link href=../../../stylesheets/custom.css rel=stylesheet><link href=../../../stylesheets/card.css rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-H7SV12D750"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-H7SV12D750",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-H7SV12D750",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7a9cfe470ed52fa0c0940a58fede385c";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>html.glightbox-open{overflow:initial;height:100%}.gslide-title{user-select:text;margin-top:0}.gslide-desc{color:#666;user-select:text}.gslide-image img{background:#fff}.gscrollbar-fixer{padding-right:15px}.gdesc-inner{font-size:.75rem}body[data-md-color-scheme=slate] .gdesc-inner{background:var(--md-default-bg-color)}body[data-md-color-scheme=slate] .gslide-title,body[data-md-color-scheme=slate] .gslide-desc{color:var(--md-default-fg-color)}</style><script src=../../../assets/javascripts/glightbox.min.js></script><body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=sunset-glow dir=ltr><script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#_1> 跳转至 </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=页眉><a aria-label="My Pamphlet Blog" class="md-header__button md-logo" title="My Pamphlet Blog" data-md-component=logo href=../../..> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> My Pamphlet Blog </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> 重新编写视觉模块记录 </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" data-md-color-media="(prefers-color-scheme: light)" class=md-option data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=sunset-glow id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg></label><input aria-label="Switch to light mode" data-md-color-media="(prefers-color-scheme: dark)" class=md-option data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=sunset-glow-dark id=__palette_2 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg></label></form><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=搜索 autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=搜索 required spellcheck=false type=text><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=查找 class=md-search__options><a class="md-search__icon md-icon" aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=分享> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a><button class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1 title=清空当前内容 type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>正在初始化搜索引擎</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a class=md-source data-md-component=source href=https://github.com/RonaldLN/MyPamphlet-Blog title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>RonaldLN/MyPamphlet-Blog</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=标签 class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../..> Blog </a></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="My Pamphlet Blog" class="md-nav__button md-logo" title="My Pamphlet Blog" data-md-component=logo href=../../..> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg> </a> My Pamphlet Blog</label><div class=md-nav__source><a class=md-source data-md-component=source href=https://github.com/RonaldLN/MyPamphlet-Blog title=前往仓库> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>RonaldLN/MyPamphlet-Blog</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_1 type=checkbox> <label class=md-nav__link for=__nav_1 id=__nav_1_label><span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_1_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> Blog</label><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--active"><a class=md-nav__link href=../../..> <span class=md-ellipsis> Blog </span> </a><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_1_2 type=checkbox> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0><span class=md-ellipsis> 归档 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_1_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_1_2><span class="md-nav__icon md-icon"></span> 归档</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../archive/2025/> <span class=md-ellipsis> 2025 </span> </a><li class=md-nav__item><a class=md-nav__link href=../../../archive/2024/> <span class=md-ellipsis> 2024 </span> </a><li class=md-nav__item><a class=md-nav__link href=../../../archive/2023/> <span class=md-ellipsis> 2023 </span> </a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" id=__nav_1_3 type=checkbox> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex=0><span class=md-ellipsis> 分类 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_1_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_1_3><span class="md-nav__icon md-icon"></span> 分类</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../../category/records-of-trivia/> <span class=md-ellipsis> Records of Trivia </span> </a><li class=md-nav__item><a class=md-nav__link href=../../../category/configure-debug/> <span class=md-ellipsis> Configure & Debug </span> </a><li class=md-nav__item><a class=md-nav__link href=../../../category/chronicle-of-events/> <span class=md-ellipsis> Chronicle of Events </span> </a></ul></nav></ul></nav></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label=目录><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> 目录</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#face_orientation_recognition> 编写 face_orientation_recognition </a></ul></nav></div></div></div><script defer src=https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/javascripts/toc.js></script><link href=https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/fold_toc.css rel=stylesheet><div class="md-content md-content--post" data-md-component=content><div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class="md-sidebar__inner md-post"><nav class="md-nav md-nav--primary"><div class=md-post__back><div class="md-nav__title md-nav__container"><a class=md-nav__link href=../../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> <span class=md-ellipsis> 回到主页 </span> </a></div></div><div class="md-post__authors md-typeset"><div class="md-profile md-post__profile"><span class="md-author md-author--long"> <img alt="Ronald Luo" src="https://avatars.githubusercontent.com/u/120019179?v=4"> </span><span class=md-profile__description> <strong>Ronald Luo</strong><br> I'm A Student </span></div></div><ul class="md-post__meta md-nav__list"><li class="md-nav__item md-nav__item--section"><div class=md-post__title><span class=md-ellipsis> 元数据 </span></div> <nav class=md-nav><ul class=md-nav__list><li class=md-nav__item><div class=md-nav__link><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg><time datetime="2024-07-04 00:00:00" class=md-ellipsis>2024年7月4日星期四</time></div><li class=md-nav__item><div class=md-nav__link><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg><span class=md-ellipsis> 分类于 <a href=../../../category/configure-debug/>Configure & Debug</a></span></div><li class=md-nav__item><div class=md-nav__link><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg><span class=md-ellipsis> 需要 7 分钟阅读时间 </span></div></ul></nav></ul></nav></div></div></div><article class="md-content__inner md-typeset"><h1 id=_1>重新编写视觉模块记录<a title="Permanent link" class=headerlink href=#_1>¶</a></h1><div style=opacity:.7;margin-top:-15px;font-size:.75em><p><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8V2m6.78 1a.69.69 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38-2.5-2.5Z"/></svg></span> 约 3412 个字 • <span class=twemoji><svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span> 265 行代码</div><p>由于以前的视觉部分的代码看起来很💩(感觉代码文件的结构很混乱，不够易读)，于是打算重新编写新的。<p>我先是分别询问了chatgpt和copilot关于如何在摄像头一直保持开启的状态下，切换使用不同的功能<details class=example open><summary>对话记录</summary> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>ChatGPT</label><label for=__tabbed_1_2>Github Copilot</label></div><div class=tabbed-content><div class=tabbed-block><p>User:<p>i have a question, There is a competition where I need to keep the camera on all the time, but different stages require the use of the camera to complete different tasks. For example, the first stage requires gesture recognition, the second stage requires face pose estimation, and both stages also require object detection. I can implement all three functions mentioned above separately (meaning that i can only implement one function when camera turned on), but I would like to ask how to switch between using different functions while keeping the camera on? how should I organize my code?<p> <p>ChatGPT:<p>To switch between different functions (gesture recognition, face pose estimation, and object detection) while keeping the camera on, you can use a modular approach in your code. Here's a general strategy:<ol><li><p><strong>Initialize the Camera:</strong> Set up the camera to capture frames continuously.</p><li><p><strong>Create Functions for Each Task:</strong> Write separate functions for gesture recognition, face pose estimation, and object detection.</p><li><p><strong>Control Flow to Switch Between Tasks:</strong> Use a control mechanism (e.g., a state machine, a flag, or a command listener) to determine which function to call on each frame.</p><li><p><strong>Main Loop:</strong> In the main loop, capture frames and call the appropriate function based on the current task.</p></ol><p>Here's a simplified example in Python using OpenCV and a basic state machine:<div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1> 1</a></span>
<span class=normal><a href=#__codelineno-0-2> 2</a></span>
<span class=normal><a href=#__codelineno-0-3> 3</a></span>
<span class=normal><a href=#__codelineno-0-4> 4</a></span>
<span class=normal><a href=#__codelineno-0-5> 5</a></span>
<span class=normal><a href=#__codelineno-0-6> 6</a></span>
<span class=normal><a href=#__codelineno-0-7> 7</a></span>
<span class=normal><a href=#__codelineno-0-8> 8</a></span>
<span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span>
<span class=normal><a href=#__codelineno-0-12>12</a></span>
<span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span></pre></div><td class=code><div><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>cv2</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=c1># Initialize the camera</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=c1># Define the functions for each task</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=k>def</span><span class=w> </span><span class=nf>gesture_recognition</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=c1># Implement gesture recognition here</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=k>pass</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=k>def</span><span class=w> </span><span class=nf>face_pose_estimation</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=c1># Implement face pose estimation here</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=k>pass</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=k>def</span><span class=w> </span><span class=nf>object_detection</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=c1># Implement object detection here</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=k>pass</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=c1># State to control which function to use</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=n>current_task</span> <span class=o>=</span> <span class=s2>"gesture_recognition"</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=c1># Main loop</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=k>while</span> <span class=n>cap</span><span class=o>.</span><span class=n>isOpened</span><span class=p>():</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span><span class=p>:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>        <span class=k>break</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=k>if</span> <span class=n>current_task</span> <span class=o>==</span> <span class=s2>"gesture_recognition"</span><span class=p>:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>        <span class=n>gesture_recognition</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=k>elif</span> <span class=n>current_task</span> <span class=o>==</span> <span class=s2>"face_pose_estimation"</span><span class=p>:</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>face_pose_estimation</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=k>elif</span> <span class=n>current_task</span> <span class=o>==</span> <span class=s2>"object_detection"</span><span class=p>:</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=n>object_detection</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=c1># Display the frame</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>'Frame'</span><span class=p>,</span> <span class=n>frame</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>    <span class=c1># Check for user input to switch tasks</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=n>key</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&</span> <span class=mh>0xFF</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=k>if</span> <span class=n>key</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>'g'</span><span class=p>):</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=n>current_task</span> <span class=o>=</span> <span class=s2>"gesture_recognition"</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>    <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>'f'</span><span class=p>):</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>        <span class=n>current_task</span> <span class=o>=</span> <span class=s2>"face_pose_estimation"</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>'o'</span><span class=p>):</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>        <span class=n>current_task</span> <span class=o>=</span> <span class=s2>"object_detection"</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>'q'</span><span class=p>):</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=k>break</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=c1># Release the camera and close windows</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=n>cap</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=n>cv2</span><span class=o>.</span><span class=n>destroyAllWindows</span><span class=p>()</span>
</span></code></pre></div></table></div><p><h3>Explanation:</h3><ol><li><p><strong>Initialize the Camera:</strong></p> <ul><li><code>cap = cv2.VideoCapture(0)</code> initializes the camera.</ul><li><p><strong>Define Functions:</strong></p> <ul><li><code>gesture_recognition</code>, <code>face_pose_estimation</code>, and <code>object_detection</code> are placeholders for your actual implementation.</ul><li><p><strong>Control Flow:</strong></p> <ul><li><code>current_task</code> is a variable that controls which function to call.<li>User input (<code>cv2.waitKey</code>) switches between tasks.</ul><li><p><strong>Main Loop:</strong></p> <ul><li>Continuously captures frames.<li>Calls the appropriate function based on the current task.<li>Displays the frame and listens for user input to switch tasks.</ul></ol><p>This approach ensures that the camera remains on and the system can switch between different tasks based on the control flow. You can modify the control mechanism to suit the specific requirements of your competition.</div><div class=tabbed-block><p>RonaldLN:<p>i have a question, There is a competition where I need to keep the camera on all the time, but different stages require the use of the camera to complete different tasks. For example, the first stage requires gesture recognition, the second stage requires face pose estimation, and both stages also require object detection. I can implement all three functions mentioned above separately (meaning that i can only implement one function when camera turned on), but I would like to ask how to switch between using different functions while keeping the camera on? how should I organize my code?<p> <p>GitHub Copilot:<p>要在保持摄像头开启的情况下切换不同的功能（如手势识别、面部姿态估计和物体检测），你可以采用以下步骤组织你的代码：<ol><li><strong>初始化摄像头</strong>：首先，初始化摄像头，确保它在整个应用程序中保持开启状态。<li><strong>定义功能模块</strong>：为手势识别、面部姿态估计和物体检测各定义一个函数或类。这样可以在需要时调用相应的功能。<li><strong>创建功能切换逻辑</strong>：根据比赛的阶段或用户的输入，决定何时切换到不同的功能。这可能涉及到监听某种信号或检查某个条件。<li><strong>循环捕获帧</strong>：在一个循环中不断从摄像头捕获帧，并根据当前的功能需求，将捕获的帧传递给相应的功能模块处理。<li><strong>处理结果</strong>：每个功能模块处理完帧之后，根据需要进行结果的显示、存储或进一步处理。</ol><p>以下是一个简化的伪代码示例：<div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1> 1</a></span>
<span class=normal><a href=#__codelineno-1-2> 2</a></span>
<span class=normal><a href=#__codelineno-1-3> 3</a></span>
<span class=normal><a href=#__codelineno-1-4> 4</a></span>
<span class=normal><a href=#__codelineno-1-5> 5</a></span>
<span class=normal><a href=#__codelineno-1-6> 6</a></span>
<span class=normal><a href=#__codelineno-1-7> 7</a></span>
<span class=normal><a href=#__codelineno-1-8> 8</a></span>
<span class=normal><a href=#__codelineno-1-9> 9</a></span>
<span class=normal><a href=#__codelineno-1-10>10</a></span>
<span class=normal><a href=#__codelineno-1-11>11</a></span>
<span class=normal><a href=#__codelineno-1-12>12</a></span>
<span class=normal><a href=#__codelineno-1-13>13</a></span>
<span class=normal><a href=#__codelineno-1-14>14</a></span>
<span class=normal><a href=#__codelineno-1-15>15</a></span>
<span class=normal><a href=#__codelineno-1-16>16</a></span>
<span class=normal><a href=#__codelineno-1-17>17</a></span>
<span class=normal><a href=#__codelineno-1-18>18</a></span>
<span class=normal><a href=#__codelineno-1-19>19</a></span>
<span class=normal><a href=#__codelineno-1-20>20</a></span>
<span class=normal><a href=#__codelineno-1-21>21</a></span>
<span class=normal><a href=#__codelineno-1-22>22</a></span>
<span class=normal><a href=#__codelineno-1-23>23</a></span>
<span class=normal><a href=#__codelineno-1-24>24</a></span>
<span class=normal><a href=#__codelineno-1-25>25</a></span>
<span class=normal><a href=#__codelineno-1-26>26</a></span>
<span class=normal><a href=#__codelineno-1-27>27</a></span>
<span class=normal><a href=#__codelineno-1-28>28</a></span>
<span class=normal><a href=#__codelineno-1-29>29</a></span>
<span class=normal><a href=#__codelineno-1-30>30</a></span>
<span class=normal><a href=#__codelineno-1-31>31</a></span>
<span class=normal><a href=#__codelineno-1-32>32</a></span>
<span class=normal><a href=#__codelineno-1-33>33</a></span>
<span class=normal><a href=#__codelineno-1-34>34</a></span>
<span class=normal><a href=#__codelineno-1-35>35</a></span></pre></div><td class=code><div><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=k>def</span><span class=w> </span><span class=nf>init_camera</span><span class=p>():</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a>    <span class=c1># 初始化摄像头</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a>    <span class=k>pass</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=k>def</span><span class=w> </span><span class=nf>gesture_recognition</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a>    <span class=c1># 处理帧进行手势识别</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a>    <span class=k>pass</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=k>def</span><span class=w> </span><span class=nf>face_pose_estimation</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a>    <span class=c1># 处理帧进行面部姿态估计</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a>    <span class=k>pass</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13></a><span class=k>def</span><span class=w> </span><span class=nf>object_detection</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14></a>    <span class=c1># 处理帧进行物体检测</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15></a>    <span class=k>pass</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16></a>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17></a><span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18></a>    <span class=n>camera</span> <span class=o>=</span> <span class=n>init_camera</span><span class=p>()</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19></a>    <span class=n>current_stage</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># 假设1为手势识别，2为面部姿态估计，3为物体检测</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20></a>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21></a>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22></a>        <span class=n>frame</span> <span class=o>=</span> <span class=n>camera</span><span class=o>.</span><span class=n>capture_frame</span><span class=p>()</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23></a>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24></a>        <span class=k>if</span> <span class=n>current_stage</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25></a>            <span class=n>gesture_recognition</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26></a>        <span class=k>elif</span> <span class=n>current_stage</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27></a>            <span class=n>face_pose_estimation</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28></a>        <span class=k>elif</span> <span class=n>current_stage</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29></a>            <span class=n>object_detection</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30></a>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31></a>        <span class=c1># 根据某些条件更新current_stage来切换功能</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32></a>        <span class=c1># 例如，基于用户输入或时间限制</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33></a>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>"__main__"</span><span class=p>:</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35></a>    <span class=n>main</span><span class=p>()</span>
</span></code></pre></div></table></div><p>这个结构允许你在不关闭摄像头的情况下，根据比赛的不同阶段或其他条件，灵活地切换不同的处理功能。</div></div></div></details><p>参考它们给出的回答，打算将每个功能封装成一个函数或者类，在主循环中需要开启使用功能就把当前从摄像头获取到的帧传入具体的函数或者类即可。<hr><p>并且打算借助git的submodule功能，让代码看的更清晰且更容易维护<p>于是先创建了 <code>vision</code> 的仓库并clone，然后创建了 <code>face_orientation_recognition</code> 和 <code>face_identification</code> 两个仓库，再在 <code>vision</code> 中添加submodule<div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>git<span class=w> </span>submodule<span class=w> </span>add<span class=w> </span>face_orientation_recognition.git<span class=w> </span>src/scripts/face_orientation_recognition
</span></code></pre></div><div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a>git<span class=w> </span>submodule<span class=w> </span>add<span class=w> </span>face_identification.git<span class=w> </span>src/scripts/face_identification
</span></code></pre></div><hr><p>而由于不是很清楚python的包中的文件结构要如何组织才能比较清晰，所以询问了一下chatgpt<details class=example><summary>对话记录</summary> <p>User:</p> <p>在python自己创建的包中，一般modules和utils 的子文件夹中，通常的含义和用途是什么？</p> <p> </p> <p>ChatGPT:</p> <p>在Python包中，<code>modules</code>和<code>utils</code>子文件夹通常有特定的用途和含义，尽管它们的确切用途可能会因项目而异。以下是它们的一些常见用途：</p> <p><h3><code>modules</code> 文件夹</h3> <ol><li><p><strong>核心功能</strong>：</p> <ul><li><code>modules</code> 文件夹通常包含实现软件或库的核心功能的模块。这些模块可以是不同的组件或功能单元，它们一起组成了整个软件系统。</ul><li><p><strong>分离关注点</strong>：</p> <ul><li>每个模块可能专注于特定的功能或任务，例如数据处理、网络通信、用户认证等。这种分离有助于提高代码的可维护性和可读性。</ul><li><p><strong>命名约定</strong>：</p> <ul><li>这个文件夹的名称“modules”并没有强制性的约定，但它通常被用来表明这些文件是程序的主要组成部分。</ul></ol> <p><h3><code>utils</code> 文件夹</h3> <ol><li><p><strong>实用工具</strong>：</p> <ul><li><code>utils</code> 文件夹通常包含各种实用工具函数或辅助函数，这些函数不是程序的核心功能，但在多个地方都可能会用到。它们通常是一些通用的、可以复用的代码片段。</ul><li><p><strong>代码复用</strong>：</p> <ul><li>将常用的辅助函数放在<code>utils</code>文件夹中，可以避免代码重复，提高代码复用性。例如，字符串处理、日期处理、文件操作等通用功能通常会放在这里。</ul><li><p><strong>组织辅助代码</strong>：</p> <ul><li>这个文件夹的存在使得主要模块的代码更加简洁，因为辅助功能被移到了一个独立的地方。这也有助于更好地组织代码。</ul></ol> <p><h3>具体例子</h3> <p>假设我们有一个名为<code>my_package</code>的包，下面是一个可能的文件夹结构：</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>my_package/
</span><span id=__span-4-2><a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>├── __init__.py
</span><span id=__span-4-3><a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>├── modules/
</span><span id=__span-4-4><a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>│   ├── data_processing.py
</span><span id=__span-4-5><a href=#__codelineno-4-5 id=__codelineno-4-5 name=__codelineno-4-5></a>│   ├── network.py
</span><span id=__span-4-6><a href=#__codelineno-4-6 id=__codelineno-4-6 name=__codelineno-4-6></a>│   └── authentication.py
</span><span id=__span-4-7><a href=#__codelineno-4-7 id=__codelineno-4-7 name=__codelineno-4-7></a>└── utils/
</span><span id=__span-4-8><a href=#__codelineno-4-8 id=__codelineno-4-8 name=__codelineno-4-8></a>    ├── string_utils.py
</span><span id=__span-4-9><a href=#__codelineno-4-9 id=__codelineno-4-9 name=__codelineno-4-9></a>    ├── date_utils.py
</span><span id=__span-4-10><a href=#__codelineno-4-10 id=__codelineno-4-10 name=__codelineno-4-10></a>    └── file_utils.py
</span></code></pre></div> <ul><li><code>data_processing.py</code>、<code>network.py</code>和<code>authentication.py</code>可能包含处理数据、网络通信和用户认证的核心代码。<li><code>string_utils.py</code>、<code>date_utils.py</code>和<code>file_utils.py</code>包含各种字符串处理、日期处理和文件操作的辅助函数。</ul> <p>这种结构有助于代码的模块化和组织，使得项目更容易维护和扩展。</p> <p> </p> <p>User:</p> <p>还有哪些常用和常见的子文件夹名呢？</p> <p> </p> <p>ChatGPT:</p> <p>在Python项目中，还有一些常见的子文件夹名称，它们通常用于特定的用途或组织代码。以下是一些常见的子文件夹名称及其用途：</p> <p><h3>常见子文件夹名称及用途</h3> <ol><li><p><strong><code>config</code></strong>：</p> <ul><li>用于存放配置文件和配置相关的代码。<li>例如，数据库配置、API密钥、应用程序设置等。</ul><li><p><strong><code>tests</code></strong>：</p> <ul><li>用于存放单元测试、集成测试和其他类型的测试代码。<li>通常包含各种测试用例来确保代码的正确性。</ul><li><p><strong><code>scripts</code></strong>：</p> <ul><li>用于存放各种脚本文件，这些脚本通常是用来执行一些特定任务或操作的。<li>例如，数据迁移脚本、自动化脚本等。</ul><li><p><strong><code>docs</code></strong>：</p> <ul><li>用于存放项目的文档和说明文件。<li>例如，用户手册、API文档、设计文档等。</ul><li><p><strong><code>examples</code></strong>：</p> <ul><li>用于存放示例代码和示例应用程序。<li>帮助用户了解如何使用库或框架。</ul><li><p><strong><code>data</code></strong>：</p> <ul><li>用于存放数据文件，例如CSV文件、JSON文件、数据库文件等。<li>常用于数据处理和机器学习项目。</ul><li><p><strong><code>assets</code></strong>：</p> <ul><li>用于存放静态资源，例如图片、样式表、JavaScript文件等。<li>常用于Web项目。</ul><li><p><strong><code>models</code></strong>：</p> <ul><li>用于存放数据模型相关的代码。<li>例如，ORM模型、机器学习模型等。</ul><li><p><strong><code>migrations</code></strong>：</p> <ul><li>用于存放数据库迁移文件。<li>常用于Django、Flask等使用ORM的Web框架。</ul><li><p><strong><code>lib</code></strong>：</p> <ul><li>用于存放外部库或依赖项。<li>例如，自定义的第三方库或依赖项。</ul><li><p><strong><code>bin</code></strong>：</p> <ul><li>用于存放可执行文件和脚本。<li>例如，命令行工具和执行脚本。</ul></ol> <p><h3>示例项目结构</h3> <p>下面是一个假设的Python项目结构示例：</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a>my_project/
</span><span id=__span-5-2><a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a>├── config/
</span><span id=__span-5-3><a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a>│   ├── settings.py
</span><span id=__span-5-4><a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a>│   └── secrets.py
</span><span id=__span-5-5><a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a>├── data/
</span><span id=__span-5-6><a href=#__codelineno-5-6 id=__codelineno-5-6 name=__codelineno-5-6></a>│   ├── input_data.csv
</span><span id=__span-5-7><a href=#__codelineno-5-7 id=__codelineno-5-7 name=__codelineno-5-7></a>│   └── processed_data.json
</span><span id=__span-5-8><a href=#__codelineno-5-8 id=__codelineno-5-8 name=__codelineno-5-8></a>├── docs/
</span><span id=__span-5-9><a href=#__codelineno-5-9 id=__codelineno-5-9 name=__codelineno-5-9></a>│   ├── README.md
</span><span id=__span-5-10><a href=#__codelineno-5-10 id=__codelineno-5-10 name=__codelineno-5-10></a>│   └── API.md
</span><span id=__span-5-11><a href=#__codelineno-5-11 id=__codelineno-5-11 name=__codelineno-5-11></a>├── examples/
</span><span id=__span-5-12><a href=#__codelineno-5-12 id=__codelineno-5-12 name=__codelineno-5-12></a>│   ├── example1.py
</span><span id=__span-5-13><a href=#__codelineno-5-13 id=__codelineno-5-13 name=__codelineno-5-13></a>│   └── example2.py
</span><span id=__span-5-14><a href=#__codelineno-5-14 id=__codelineno-5-14 name=__codelineno-5-14></a>├── lib/
</span><span id=__span-5-15><a href=#__codelineno-5-15 id=__codelineno-5-15 name=__codelineno-5-15></a>│   └── custom_library.py
</span><span id=__span-5-16><a href=#__codelineno-5-16 id=__codelineno-5-16 name=__codelineno-5-16></a>├── models/
</span><span id=__span-5-17><a href=#__codelineno-5-17 id=__codelineno-5-17 name=__codelineno-5-17></a>│   ├── user_model.py
</span><span id=__span-5-18><a href=#__codelineno-5-18 id=__codelineno-5-18 name=__codelineno-5-18></a>│   └── product_model.py
</span><span id=__span-5-19><a href=#__codelineno-5-19 id=__codelineno-5-19 name=__codelineno-5-19></a>├── modules/
</span><span id=__span-5-20><a href=#__codelineno-5-20 id=__codelineno-5-20 name=__codelineno-5-20></a>│   ├── data_processing.py
</span><span id=__span-5-21><a href=#__codelineno-5-21 id=__codelineno-5-21 name=__codelineno-5-21></a>│   ├── network.py
</span><span id=__span-5-22><a href=#__codelineno-5-22 id=__codelineno-5-22 name=__codelineno-5-22></a>│   └── authentication.py
</span><span id=__span-5-23><a href=#__codelineno-5-23 id=__codelineno-5-23 name=__codelineno-5-23></a>├── scripts/
</span><span id=__span-5-24><a href=#__codelineno-5-24 id=__codelineno-5-24 name=__codelineno-5-24></a>│   ├── migrate_data.py
</span><span id=__span-5-25><a href=#__codelineno-5-25 id=__codelineno-5-25 name=__codelineno-5-25></a>│   └── cleanup.py
</span><span id=__span-5-26><a href=#__codelineno-5-26 id=__codelineno-5-26 name=__codelineno-5-26></a>├── tests/
</span><span id=__span-5-27><a href=#__codelineno-5-27 id=__codelineno-5-27 name=__codelineno-5-27></a>│   ├── test_data_processing.py
</span><span id=__span-5-28><a href=#__codelineno-5-28 id=__codelineno-5-28 name=__codelineno-5-28></a>│   ├── test_network.py
</span><span id=__span-5-29><a href=#__codelineno-5-29 id=__codelineno-5-29 name=__codelineno-5-29></a>│   └── test_authentication.py
</span><span id=__span-5-30><a href=#__codelineno-5-30 id=__codelineno-5-30 name=__codelineno-5-30></a>└── utils/
</span><span id=__span-5-31><a href=#__codelineno-5-31 id=__codelineno-5-31 name=__codelineno-5-31></a>    ├── string_utils.py
</span><span id=__span-5-32><a href=#__codelineno-5-32 id=__codelineno-5-32 name=__codelineno-5-32></a>    ├── date_utils.py
</span><span id=__span-5-33><a href=#__codelineno-5-33 id=__codelineno-5-33 name=__codelineno-5-33></a>    └── file_utils.py
</span></code></pre></div> <p>这种结构清晰地组织了项目的各个部分，使得项目易于导航和维护。不同的文件夹根据其用途分类，使得代码管理更加高效。</p> <p> </p> <p>User:</p> <p>lib , models, modules, scripts, utils, config 这几个之间的区别，你能再详细说一下吗？</p> <p> </p> <p>ChatGPT:</p> <p>当然，以下是对 <code>lib</code>、<code>models</code>、<code>modules</code>、<code>scripts</code>、<code>utils</code> 和 <code>config</code> 这几个文件夹之间的详细区别和用途解释：</p> <p><h3><code>lib</code></h3> <p><strong>用途</strong>： - 用于存放外部库或自定义的库文件。这些库文件可能是从外部引入的第三方库，也可能是项目中自定义的、可复用的代码模块。</p> <p><strong>典型内容</strong>： - 第三方库的包装器 - 自定义的工具库 - 不依赖于项目具体业务逻辑的通用库</p> <p><strong>示例</strong>：<div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=n>lib</span><span class=o>/</span>
</span><span id=__span-6-2><a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a><span class=err>├──</span> <span class=n>custom_library</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-6-3><a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a><span class=err>└──</span> <span class=n>third_party_wrapper</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3><code>models</code></h3> <p><strong>用途</strong>： - 用于存放数据模型相关的代码。这些模型通常表示项目中使用的数据结构，例如数据库表、机器学习模型等。</p> <p><strong>典型内容</strong>： - ORM（对象关系映射）模型（如Django或SQLAlchemy的模型） - 机器学习模型的定义和训练代码 - 数据结构定义</p> <p><strong>示例</strong>：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a><span class=n>models</span><span class=o>/</span>
</span><span id=__span-7-2><a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a><span class=err>├──</span> <span class=n>user_model</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-7-3><a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a><span class=err>├──</span> <span class=n>product_model</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-7-4><a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a><span class=err>└──</span> <span class=n>ml_model</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3><code>modules</code></h3> <p><strong>用途</strong>： - 用于存放实现软件或库的核心功能的模块。这些模块是项目的主要组成部分，包含主要的业务逻辑和功能实现。</p> <p><strong>典型内容</strong>： - 各种功能模块，如数据处理、网络通信、用户认证等 - 每个模块通常专注于特定的功能或任务</p> <p><strong>示例</strong>：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=n>modules</span><span class=o>/</span>
</span><span id=__span-8-2><a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a><span class=err>├──</span> <span class=n>data_processing</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-8-3><a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a><span class=err>├──</span> <span class=n>network</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-8-4><a href=#__codelineno-8-4 id=__codelineno-8-4 name=__codelineno-8-4></a><span class=err>└──</span> <span class=n>authentication</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3><code>scripts</code></h3> <p><strong>用途</strong>： - 用于存放各种脚本文件，这些脚本通常是用来执行特定任务或操作的，例如数据迁移、自动化任务等。</p> <p><strong>典型内容</strong>： - 数据迁移脚本 - 自动化脚本 - 启动和部署脚本</p> <p><strong>示例</strong>：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a><span class=n>scripts</span><span class=o>/</span>
</span><span id=__span-9-2><a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a><span class=err>├──</span> <span class=n>migrate_data</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-9-3><a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a><span class=err>└──</span> <span class=n>cleanup</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3><code>utils</code></h3> <p><strong>用途</strong>： - 用于存放各种实用工具函数或辅助函数，这些函数不是项目的核心功能，但在多个地方都可能会用到，提供辅助支持。</p> <p><strong>典型内容</strong>： - 通用的工具函数，例如字符串处理、日期处理、文件操作等 - 可以被多个模块复用的代码</p> <p><strong>示例</strong>：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=n>utils</span><span class=o>/</span>
</span><span id=__span-10-2><a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a><span class=err>├──</span> <span class=n>string_utils</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-10-3><a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a><span class=err>├──</span> <span class=n>date_utils</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-10-4><a href=#__codelineno-10-4 id=__codelineno-10-4 name=__codelineno-10-4></a><span class=err>└──</span> <span class=n>file_utils</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3><code>config</code></h3> <p><strong>用途</strong>： - 用于存放配置文件和配置相关的代码。这些配置文件通常包含项目的各种设置和参数，例如数据库配置、API密钥等。</p> <p><strong>典型内容</strong>： - 应用程序设置 - 环境变量配置 - 安全和敏感信息（通常需要安全管理）</p> <p><strong>示例</strong>：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=n>config</span><span class=o>/</span>
</span><span id=__span-11-2><a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a><span class=err>├──</span> <span class=n>settings</span><span class=o>.</span><span class=n>py</span>
</span><span id=__span-11-3><a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a><span class=err>└──</span> <span class=n>secrets</span><span class=o>.</span><span class=n>py</span>
</span></code></pre></div> <p><h3>总结对比</h3> <ul><li><strong><code>lib</code></strong>：外部或自定义的库文件，不特定于项目的业务逻辑。<li><strong><code>models</code></strong>：数据模型定义和相关代码，表示项目中的数据结构。<li><strong><code>modules</code></strong>：核心功能模块，包含主要业务逻辑。<li><strong><code>scripts</code></strong>：执行特定任务或操作的脚本文件。<li><strong><code>utils</code></strong>：通用工具函数和辅助函数，提供支持和复用。<li><strong><code>config</code></strong>：配置文件和相关代码，管理项目设置和参数。</ul> <p>这种分类和组织方式有助于保持项目结构清晰，便于维护和扩展。</p></details><hr><h2 id=face_orientation_recognition>编写 <code>face_orientation_recognition</code><a title="Permanent link" class=headerlink href=#face_orientation_recognition>¶</a></h2><p>于是将 <code>head-pose-estimation</code> 中的 <code>face_detection.py</code> <code>mark_detection.py</code> <code>pose_estimation.py</code> 移动到 <code>face_orientation_recognition/modules/</code> 下，<code>utils.py</code> <code>assets/</code> 移动到 <code>face_orientation_recognition/</code> 下<p>参照 <code>main.py</code> ，在 <code>face_orientation_recognition/</code> 下编写 <code>orientation_recognition.py</code><div class="language-python highlight"><span class=filename>orientation_recognition.py</span><pre><span></span><code><span id=__span-12-1><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=kn>import</span><span class=w> </span><span class=nn>cv2</span>
</span><span id=__span-12-2><a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-12-3><a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a>
</span><span id=__span-12-4><a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a><span class=kn>from</span><span class=w> </span><span class=nn>modules.face_detection</span><span class=w> </span><span class=kn>import</span> <span class=n>FaceDetector</span>
</span><span id=__span-12-5><a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a><span class=kn>from</span><span class=w> </span><span class=nn>modules.mark_detection</span><span class=w> </span><span class=kn>import</span> <span class=n>MarkDetector</span>
</span><span id=__span-12-6><a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a><span class=kn>from</span><span class=w> </span><span class=nn>modules.pose_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>PoseEstimator</span>
</span><span id=__span-12-7><a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a><span class=kn>from</span><span class=w> </span><span class=nn>utils</span><span class=w> </span><span class=kn>import</span> <span class=n>refine</span>
</span><span id=__span-12-8><a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a>
</span><span id=__span-12-9><a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a>
</span><span id=__span-12-10><a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a><span class=k>class</span><span class=w> </span><span class=nc>OrientationRecognizer</span><span class=p>:</span>
</span><span id=__span-12-11><a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>frame_width</span><span class=p>,</span> <span class=n>frame_height</span><span class=p>):</span>
</span><span id=__span-12-12><a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a>        <span class=o>...</span>
</span><span id=__span-12-13><a href=#__codelineno-12-13 id=__codelineno-12-13 name=__codelineno-12-13></a>
</span><span id=__span-12-14><a href=#__codelineno-12-14 id=__codelineno-12-14 name=__codelineno-12-14></a>    <span class=k>def</span><span class=w> </span><span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>frame</span><span class=p>):</span>
</span><span id=__span-12-15><a href=#__codelineno-12-15 id=__codelineno-12-15 name=__codelineno-12-15></a>        <span class=o>...</span>
</span><span id=__span-12-16><a href=#__codelineno-12-16 id=__codelineno-12-16 name=__codelineno-12-16></a>
</span><span id=__span-12-17><a href=#__codelineno-12-17 id=__codelineno-12-17 name=__codelineno-12-17></a>
</span><span id=__span-12-18><a href=#__codelineno-12-18 id=__codelineno-12-18 name=__codelineno-12-18></a><span class=k>def</span><span class=w> </span><span class=nf>get_orientation_angle</span><span class=p>(</span><span class=n>pose</span><span class=p>):</span>
</span><span id=__span-12-19><a href=#__codelineno-12-19 id=__codelineno-12-19 name=__codelineno-12-19></a>    <span class=o>...</span>
</span><span id=__span-12-20><a href=#__codelineno-12-20 id=__codelineno-12-20 name=__codelineno-12-20></a>
</span><span id=__span-12-21><a href=#__codelineno-12-21 id=__codelineno-12-21 name=__codelineno-12-21></a><span class=k>def</span><span class=w> </span><span class=nf>get_adjustment</span><span class=p>(</span><span class=n>angle</span><span class=p>):</span>
</span><span id=__span-12-22><a href=#__codelineno-12-22 id=__codelineno-12-22 name=__codelineno-12-22></a>    <span class=o>...</span>
</span></code></pre></div><p>然后在 <code>vision/</code> 下测试使用这个包<div class="language-python highlight"><table class=highlighttable><tr><th class=filename colspan=2><span class=filename>vision/test.py</span><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-13-1> 1</a></span>
<span class=normal><a href=#__codelineno-13-2> 2</a></span>
<span class=normal><a href=#__codelineno-13-3> 3</a></span>
<span class=normal><a href=#__codelineno-13-4> 4</a></span>
<span class=normal><a href=#__codelineno-13-5> 5</a></span>
<span class=normal><a href=#__codelineno-13-6> 6</a></span>
<span class=normal><a href=#__codelineno-13-7> 7</a></span>
<span class=normal><a href=#__codelineno-13-8> 8</a></span>
<span class=normal><a href=#__codelineno-13-9> 9</a></span>
<span class=normal><a href=#__codelineno-13-10>10</a></span>
<span class=normal><a href=#__codelineno-13-11>11</a></span>
<span class=normal><a href=#__codelineno-13-12>12</a></span>
<span class=normal><a href=#__codelineno-13-13>13</a></span>
<span class=normal><a href=#__codelineno-13-14>14</a></span>
<span class=normal><a href=#__codelineno-13-15>15</a></span>
<span class=normal><a href=#__codelineno-13-16>16</a></span>
<span class=normal><a href=#__codelineno-13-17>17</a></span>
<span class=normal><a href=#__codelineno-13-18>18</a></span>
<span class=normal><a href=#__codelineno-13-19>19</a></span>
<span class=normal><a href=#__codelineno-13-20>20</a></span>
<span class=normal><a href=#__codelineno-13-21>21</a></span>
<span class=normal><a href=#__codelineno-13-22>22</a></span>
<span class=normal><a href=#__codelineno-13-23>23</a></span>
<span class=normal><a href=#__codelineno-13-24>24</a></span>
<span class=normal><a href=#__codelineno-13-25>25</a></span></pre></div><td class=code><div><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>cv2</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2></a><span class=kn>from</span><span class=w> </span><span class=nn>face_orientation_recognition.face_orientation</span><span class=w> </span><span class=kn>import</span> <span class=n>OrientationRecognizer</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4></a><span class=n>cap</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5></a>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6></a><span class=n>frame_width</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_WIDTH</span><span class=p>))</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7></a><span class=n>frame_height</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cap</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_HEIGHT</span><span class=p>))</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8></a>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9></a><span class=n>estimator</span> <span class=o>=</span> <span class=n>OrientationRecognizer</span><span class=p>(</span><span class=n>frame_width</span><span class=p>,</span> <span class=n>frame_height</span><span class=p>)</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10></a>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11></a><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12></a>    <span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>cap</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span><span class=p>:</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14></a>        <span class=k>break</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15></a>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16></a>    <span class=n>has_face</span><span class=p>,</span> <span class=n>estimated_frame</span><span class=p>,</span> <span class=n>angle</span><span class=p>,</span> <span class=n>adjustment</span> <span class=o>=</span> <span class=n>estimator</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17></a>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18></a>    <span class=k>if</span> <span class=n>has_face</span><span class=p>:</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>'frame'</span><span class=p>,</span> <span class=n>estimated_frame</span><span class=p>)</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>'angle: </span><span class=si>{</span><span class=n>angle</span><span class=si>}</span><span class=s1>, adjustment: </span><span class=si>{</span><span class=n>adjustment</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22></a>        <span class=n>cv2</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=s1>'frame'</span><span class=p>,</span> <span class=n>frame</span><span class=p>)</span>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23></a>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24></a>    <span class=k>if</span> <span class=n>cv2</span><span class=o>.</span><span class=n>waitKey</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&</span> <span class=mh>0xFF</span> <span class=o>==</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>'q'</span><span class=p>):</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25></a>        <span class=k>break</span>
</span></code></pre></div></table></div><p>出现了报错<div class="language-bash highlight"><pre><span></span><code><span id=__span-14-1><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a>Traceback<span class=w> </span><span class=o>(</span>most<span class=w> </span>recent<span class=w> </span>call<span class=w> </span>last<span class=o>)</span>:
</span><span id=__span-14-2><a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a><span class=w>  </span>File<span class=w> </span><span class=s2>"c:\Github\vision\src\scripts\test.py"</span>,<span class=w> </span>line<span class=w> </span><span class=m>2</span>,<span class=w> </span><span class=k>in</span><span class=w> </span>&lt;module>
</span><span id=__span-14-3><a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a><span class=w>    </span>from<span class=w> </span>face_orientation_recognition.face_orientation<span class=w> </span>import<span class=w> </span>OrientationRecognizer
</span><span id=__span-14-4><a href=#__codelineno-14-4 id=__codelineno-14-4 name=__codelineno-14-4></a><span class=w>  </span>File<span class=w> </span><span class=s2>"c:\Github\vision\src\scripts\face_orientation_recognition\face_orientation.py"</span>,<span class=w> </span>line<span class=w> </span><span class=m>10</span>,<span class=w> </span><span class=k>in</span><span class=w> </span>&lt;module>
</span><span id=__span-14-5><a href=#__codelineno-14-5 id=__codelineno-14-5 name=__codelineno-14-5></a><span class=w>    </span>from<span class=w> </span>modules.face_detection<span class=w> </span>import<span class=w> </span>FaceDetector
</span><span id=__span-14-6><a href=#__codelineno-14-6 id=__codelineno-14-6 name=__codelineno-14-6></a>ModuleNotFoundError:<span class=w> </span>No<span class=w> </span>module<span class=w> </span>named<span class=w> </span><span class=s1>'modules'</span>
</span></code></pre></div><p>发现是需要使用<strong>相对导入</strong><blockquote><p>我参考了yolov8中的代码<p><a href=https://github.com/ultralytics/ultralytics/blob/5d479c73c2933fa5020632e1b2d5b77220dce156/ultralytics/trackers/byte_tracker.py>ultralytics/ultralytics/trackers/byte_tracker.py at 5d479c73c2933fa5020632e1b2d5b77220dce156 · ultralytics/ultralytics (github.com)</a><div class="language-python highlight"><span class=filename>byte_tracker.py</span><pre><span></span><code><span id=__span-15-1><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a><span class=c1># Ultralytics YOLO 🚀, AGPL-3.0 license</span>
</span><span id=__span-15-2><a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a>
</span><span id=__span-15-3><a href=#__codelineno-15-3 id=__codelineno-15-3 name=__codelineno-15-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-15-4><a href=#__codelineno-15-4 id=__codelineno-15-4 name=__codelineno-15-4></a>
</span><span id=__span-15-5><a href=#__codelineno-15-5 id=__codelineno-15-5 name=__codelineno-15-5></a><span class=kn>from</span><span class=w> </span><span class=nn>..utils</span><span class=w> </span><span class=kn>import</span> <span class=n>LOGGER</span>
</span><span id=__span-15-6><a href=#__codelineno-15-6 id=__codelineno-15-6 name=__codelineno-15-6></a><span class=kn>from</span><span class=w> </span><span class=nn>..utils.ops</span><span class=w> </span><span class=kn>import</span> <span class=n>xywh2ltwh</span>
</span><span id=__span-15-7><a href=#__codelineno-15-7 id=__codelineno-15-7 name=__codelineno-15-7></a><span class=kn>from</span><span class=w> </span><span class=nn>.basetrack</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseTrack</span><span class=p>,</span> <span class=n>TrackState</span>
</span><span id=__span-15-8><a href=#__codelineno-15-8 id=__codelineno-15-8 name=__codelineno-15-8></a><span class=kn>from</span><span class=w> </span><span class=nn>.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>matching</span>
</span><span id=__span-15-9><a href=#__codelineno-15-9 id=__codelineno-15-9 name=__codelineno-15-9></a><span class=kn>from</span><span class=w> </span><span class=nn>.utils.kalman_filter</span><span class=w> </span><span class=kn>import</span> <span class=n>KalmanFilterXYAH</span>
</span></code></pre></div></blockquote><p>将 <code>face_orientation.py</code> 修改成相对导入<div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a><span class=kn>import</span><span class=w> </span><span class=nn>cv2</span>
</span><span id=__span-16-2><a href=#__codelineno-16-2 id=__codelineno-16-2 name=__codelineno-16-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-16-3><a href=#__codelineno-16-3 id=__codelineno-16-3 name=__codelineno-16-3></a>
</span><span id=__span-16-4><a href=#__codelineno-16-4 id=__codelineno-16-4 name=__codelineno-16-4></a><span class=hll><span class=kn>from</span><span class=w> </span><span class=nn>.modules.face_detection</span><span class=w> </span><span class=kn>import</span> <span class=n>FaceDetector</span>
</span></span><span id=__span-16-5><a href=#__codelineno-16-5 id=__codelineno-16-5 name=__codelineno-16-5></a><span class=hll><span class=kn>from</span><span class=w> </span><span class=nn>.modules.mark_detection</span><span class=w> </span><span class=kn>import</span> <span class=n>MarkDetector</span>
</span></span><span id=__span-16-6><a href=#__codelineno-16-6 id=__codelineno-16-6 name=__codelineno-16-6></a><span class=hll><span class=kn>from</span><span class=w> </span><span class=nn>.modules.pose_estimation</span><span class=w> </span><span class=kn>import</span> <span class=n>PoseEstimator</span>
</span></span><span id=__span-16-7><a href=#__codelineno-16-7 id=__codelineno-16-7 name=__codelineno-16-7></a><span class=hll><span class=kn>from</span><span class=w> </span><span class=nn>.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>refine</span>
</span></span></code></pre></div><p>再次运行，出现了导入模型文件的报错<div class="language-bash highlight"><pre><span></span><code><span id=__span-17-1><a href=#__codelineno-17-1 id=__codelineno-17-1 name=__codelineno-17-1></a>Traceback<span class=w> </span><span class=o>(</span>most<span class=w> </span>recent<span class=w> </span>call<span class=w> </span>last<span class=o>)</span>:
</span><span id=__span-17-2><a href=#__codelineno-17-2 id=__codelineno-17-2 name=__codelineno-17-2></a><span class=w>  </span>File<span class=w> </span><span class=s2>"c:\Github\vision\src\scripts\test.py"</span>,<span class=w> </span>line<span class=w> </span><span class=m>9</span>,<span class=w> </span><span class=k>in</span><span class=w> </span>&lt;module><span class=w>  </span>
</span><span id=__span-17-3><a href=#__codelineno-17-3 id=__codelineno-17-3 name=__codelineno-17-3></a><span class=w>    </span><span class=nv>estimator</span><span class=w> </span><span class=o>=</span><span class=w> </span>OrientationRecognizer<span class=o>(</span>frame_width,<span class=w> </span>frame_height<span class=o>)</span><span class=w>    </span>
</span><span id=__span-17-4><a href=#__codelineno-17-4 id=__codelineno-17-4 name=__codelineno-17-4></a><span class=w>  </span>File<span class=w> </span><span class=s2>"c:\Github\vision\src\scripts\face_orientation_recognition\face_orientation.py"</span>,<span class=w> </span>line<span class=w> </span><span class=m>35</span>,<span class=w> </span><span class=k>in</span><span class=w> </span>__init__
</span><span id=__span-17-5><a href=#__codelineno-17-5 id=__codelineno-17-5 name=__codelineno-17-5></a><span class=w>    </span>self.face_detector<span class=w> </span><span class=o>=</span><span class=w> </span>FaceDetector<span class=o>(</span><span class=s2>"assets/face_detector.onnx"</span><span class=o>)</span><span class=w>  </span>
</span><span id=__span-17-6><a href=#__codelineno-17-6 id=__codelineno-17-6 name=__codelineno-17-6></a><span class=w>  </span>File<span class=w> </span><span class=s2>"c:\Github\vision\src\scripts\face_orientation_recognition\modules\face_detection.py"</span>,<span class=w> </span>line<span class=w> </span><span class=m>67</span>,<span class=w> </span><span class=k>in</span><span class=w> </span>__init__
</span><span id=__span-17-7><a href=#__codelineno-17-7 id=__codelineno-17-7 name=__codelineno-17-7></a><span class=w>    </span>assert<span class=w> </span>os.path.exists<span class=o>(</span>model_file<span class=o>)</span>,<span class=w> </span>f<span class=s2>"File not found: {model_file}"</span>
</span><span id=__span-17-8><a href=#__codelineno-17-8 id=__codelineno-17-8 name=__codelineno-17-8></a>AssertionError:<span class=w> </span>File<span class=w> </span>not<span class=w> </span>found:<span class=w> </span>assets/face_detector.onnx
</span></code></pre></div><p>于是询问copilot<details class=example open><summary>对话记录</summary> <p>RonaldLN:</p> <p><code>@terminal</code> <code>/explain</code> <code>#terminalLastCommand</code></p> <p> </p> <p>Github Copilot:</p> <p>根据您提供的终端最后运行命令的上下文，错误信息表明在初始化 <code>OrientationRecognizer</code> 对象时，尝试加载 <code>face_detector.onnx</code> 模型文件失败，因为无法在指定的路径 <code>assets/face_detector.onnx</code> 找到该文件。</p> <p>这个问题通常是因为文件路径不正确或者文件确实不存在于预期的位置。解决这个问题的方法包括：</p> <ol><li><p><strong>检查文件是否存在</strong>：首先，确保 <code>face_detector.onnx</code> 文件确实存在于项目的 <code>assets</code> 目录下。你需要在 <code>C:\Github\vision</code> 目录下查找 <code>assets</code> 目录，并确认 <code>face_detector.onnx</code> 文件是否在那里。</p><li><p><strong>正确设置文件路径</strong>：如果 <code>assets</code> 目录和 <code>face_detector.onnx</code> 文件都存在，但仍然出现错误，可能是因为程序运行时的当前工作目录（CWD）不是你预期的目录。在这种情况下，你可以使用绝对路径或者相对于当前脚本文件的路径来引用模型文件。例如，如果你的脚本位于 <code>c:\Github\vision\src\scripts</code> 目录下，你可以这样修改代码：</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a href=#__codelineno-18-1 id=__codelineno-18-1 name=__codelineno-18-1></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span><span id=__span-18-2><a href=#__codelineno-18-2 id=__codelineno-18-2 name=__codelineno-18-2></a>
</span><span id=__span-18-3><a href=#__codelineno-18-3 id=__codelineno-18-3 name=__codelineno-18-3></a><span class=c1># 获取当前脚本文件的目录</span>
</span><span id=__span-18-4><a href=#__codelineno-18-4 id=__codelineno-18-4 name=__codelineno-18-4></a><span class=n>current_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span>
</span><span id=__span-18-5><a href=#__codelineno-18-5 id=__codelineno-18-5 name=__codelineno-18-5></a><span class=c1># 构建模型文件的绝对路径</span>
</span><span id=__span-18-6><a href=#__codelineno-18-6 id=__codelineno-18-6 name=__codelineno-18-6></a><span class=n>model_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_dir</span><span class=p>,</span> <span class=s2>".."</span><span class=p>,</span> <span class=s2>".."</span><span class=p>,</span> <span class=s2>"assets"</span><span class=p>,</span> <span class=s2>"face_detector.onnx"</span><span class=p>)</span>
</span><span id=__span-18-7><a href=#__codelineno-18-7 id=__codelineno-18-7 name=__codelineno-18-7></a>
</span><span id=__span-18-8><a href=#__codelineno-18-8 id=__codelineno-18-8 name=__codelineno-18-8></a><span class=bp>self</span><span class=o>.</span><span class=n>face_detector</span> <span class=o>=</span> <span class=n>FaceDetector</span><span class=p>(</span><span class=n>model_path</span><span class=p>)</span>
</span></code></pre></div> <p>这段代码使用 <code>os.path</code> 模块来构建 <code>face_detector.onnx</code> 文件的绝对路径，无论当前的工作目录是什么，都能正确地找到文件。</p><li><p><strong>确保路径分隔符正确</strong>：在 Windows 系统上，路径分隔符是反斜杠 <code>\</code>，而在 UNIX-like 系统上（包括 Linux 和 macOS），路径分隔符是正斜杠 <code>/</code>。虽然 Python 通常可以正确处理这些差异，但在某些情况下，确保使用正确的路径分隔符可能会避免路径问题。<code>os.path.join</code> 方法可以自动处理这种差异，所以推荐使用。</p></ol> <p>通过上述方法之一，你应该能够解决找不到模型文件的问题。</p></details><p>于是进行修改<div class="language-python highlight"><span class=filename>face_orientation.py</span><pre><span></span><code><span id=__span-19-1><a href=#__codelineno-19-1 id=__codelineno-19-1 name=__codelineno-19-1></a><span class=hll><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span></span><span id=__span-19-2><a href=#__codelineno-19-2 id=__codelineno-19-2 name=__codelineno-19-2></a><span class=o>...</span>
</span><span id=__span-19-3><a href=#__codelineno-19-3 id=__codelineno-19-3 name=__codelineno-19-3></a><span class=k>class</span><span class=w> </span><span class=nc>OrientationRecognizer</span><span class=p>:</span>
</span><span id=__span-19-4><a href=#__codelineno-19-4 id=__codelineno-19-4 name=__codelineno-19-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>frame_width</span><span class=p>,</span> <span class=n>frame_height</span><span class=p>):</span>
</span><span id=__span-19-5><a href=#__codelineno-19-5 id=__codelineno-19-5 name=__codelineno-19-5></a>        <span class=o>...</span>
</span><span id=__span-19-6><a href=#__codelineno-19-6 id=__codelineno-19-6 name=__codelineno-19-6></a><span class=hll>        <span class=c1># 获取当前脚本文件的目录</span>
</span></span><span id=__span-19-7><a href=#__codelineno-19-7 id=__codelineno-19-7 name=__codelineno-19-7></a><span class=hll>        <span class=n>current_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span>
</span></span><span id=__span-19-8><a href=#__codelineno-19-8 id=__codelineno-19-8 name=__codelineno-19-8></a>
</span><span id=__span-19-9><a href=#__codelineno-19-9 id=__codelineno-19-9 name=__codelineno-19-9></a>        <span class=c1># Setup a face detector to detect human faces.</span>
</span><span id=__span-19-10><a href=#__codelineno-19-10 id=__codelineno-19-10 name=__codelineno-19-10></a><span class=hll>        <span class=bp>self</span><span class=o>.</span><span class=n>face_detector</span> <span class=o>=</span> <span class=n>FaceDetector</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_dir</span><span class=p>,</span> <span class=s2>"assets"</span><span class=p>,</span> <span class=s2>"face_detector.onnx"</span><span class=p>))</span>
</span></span><span id=__span-19-11><a href=#__codelineno-19-11 id=__codelineno-19-11 name=__codelineno-19-11></a>
</span><span id=__span-19-12><a href=#__codelineno-19-12 id=__codelineno-19-12 name=__codelineno-19-12></a>        <span class=c1># Setup a mark detector to detect landmarks.</span>
</span><span id=__span-19-13><a href=#__codelineno-19-13 id=__codelineno-19-13 name=__codelineno-19-13></a><span class=hll>        <span class=bp>self</span><span class=o>.</span><span class=n>mark_detector</span> <span class=o>=</span> <span class=n>MarkDetector</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_dir</span><span class=p>,</span> <span class=s2>"assets"</span><span class=p>,</span> <span class=s2>"face_landmarks.onnx"</span><span class=p>))</span>
</span></span><span id=__span-19-14><a href=#__codelineno-19-14 id=__codelineno-19-14 name=__codelineno-19-14></a>        <span class=o>...</span>
</span></code></pre></div><div class="language-python highlight"><span class=filename>modules/pose_estimation.py</span><pre><span></span><code><span id=__span-20-1><a href=#__codelineno-20-1 id=__codelineno-20-1 name=__codelineno-20-1></a><span class=hll><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span></span><span id=__span-20-2><a href=#__codelineno-20-2 id=__codelineno-20-2 name=__codelineno-20-2></a><span class=hll>
</span></span><span id=__span-20-3><a href=#__codelineno-20-3 id=__codelineno-20-3 name=__codelineno-20-3></a><span class=hll>
</span></span><span id=__span-20-4><a href=#__codelineno-20-4 id=__codelineno-20-4 name=__codelineno-20-4></a><span class=hll><span class=c1># 获取当前脚本文件的目录</span>
</span></span><span id=__span-20-5><a href=#__codelineno-20-5 id=__codelineno-20-5 name=__codelineno-20-5></a><span class=hll><span class=n>current_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))</span>
</span></span><span id=__span-20-6><a href=#__codelineno-20-6 id=__codelineno-20-6 name=__codelineno-20-6></a><span class=hll><span class=c1># 模型文件的绝对路径</span>
</span></span><span id=__span-20-7><a href=#__codelineno-20-7 id=__codelineno-20-7 name=__codelineno-20-7></a><span class=hll><span class=n>model_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>current_dir</span><span class=p>,</span> <span class=s2>".."</span><span class=p>,</span> <span class=s2>"assets"</span><span class=p>,</span> <span class=s2>"model.txt"</span><span class=p>)</span>
</span></span><span id=__span-20-8><a href=#__codelineno-20-8 id=__codelineno-20-8 name=__codelineno-20-8></a>
</span><span id=__span-20-9><a href=#__codelineno-20-9 id=__codelineno-20-9 name=__codelineno-20-9></a><span class=o>...</span>
</span><span id=__span-20-10><a href=#__codelineno-20-10 id=__codelineno-20-10 name=__codelineno-20-10></a>
</span><span id=__span-20-11><a href=#__codelineno-20-11 id=__codelineno-20-11 name=__codelineno-20-11></a><span class=k>class</span><span class=w> </span><span class=nc>PoseEstimator</span><span class=p>:</span>
</span><span id=__span-20-12><a href=#__codelineno-20-12 id=__codelineno-20-12 name=__codelineno-20-12></a>    <span class=o>...</span>
</span><span id=__span-20-13><a href=#__codelineno-20-13 id=__codelineno-20-13 name=__codelineno-20-13></a><span class=hll>    <span class=k>def</span><span class=w> </span><span class=nf>_get_full_model_points</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=o>=</span><span class=n>model_path</span><span class=p>):</span>
</span></span><span id=__span-20-14><a href=#__codelineno-20-14 id=__codelineno-20-14 name=__codelineno-20-14></a>        <span class=o>...</span>
</span></code></pre></div><p>再次运行，就能够使用摄像头进行检测了<hr><p>然后继续写 <code>face_identification</code> ，有了 <code>face_orientation_recognition</code> 的经验，这个就简单很多了，很快就弄完了<hr><div class=md-source-file><small> 最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-07-05T00:43:58+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-07-05</span> <br> 创建日期: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-07-05T00:43:58+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-07-05</span> </small></div><h2 id=__comments>评论</h2><script async crossorigin data-category=Announcements data-category-id=DIC_kwDOKTCz0s4CZ2M5 data-emit-metadata=1 data-input-position=top data-lang=zh-CN data-loading=lazy data-mapping=pathname data-reactions-enabled=1 data-repo=RonaldLN/MyPamphlet-Blog data-repo-id=R_kgDOKTCz0g data-strict=0 data-theme=https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/giscus_sunset_glow.css src=https://giscus.app/client.js></script><script>var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "sunset-glow-dark"
        ? "https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/giscus_sunset_glow_dark.css"
        : "https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/giscus_sunset_glow.css"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "sunset-glow-dark"
            ? "https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/giscus_sunset_glow_dark.css"
            : "https://cdn.jsdelivr.net/gh/RonaldLN/MyPamphlet-Blog@main/docs/stylesheets/giscus_sunset_glow.css"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })</script></article></div></div><button class="md-top md-icon" data-md-component=top hidden type=button><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部</button></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=页脚><a aria-label="上一页: 实现人脸比对功能的记录" class="md-footer__link md-footer__link--prev" href=../03/> <div class="md-footer__button md-icon"><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></div> <div class=md-footer__title><span class=md-footer__direction> 上一页 </span><div class=md-ellipsis>实现人脸比对功能的记录</div></div> </a><a aria-label="下一页: 在Python中实现使用MediaPipe摄像头视频流识别手势并显示标注图像" class="md-footer__link md-footer__link--next" href=../06/pythonmediapipe/> <div class=md-footer__title><span class=md-footer__direction> 下一页 </span><div class=md-ellipsis>在Python中实现使用MediaPipe摄像头视频流识别手势并显示标注图像</div></div> <div class="md-footer__button md-icon"><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg></div> </a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight>Copyright © 2023 - 2025 Ronald Luo</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-progress data-md-component=progress role=progressbar></div><script id=__config type=application/json>{"base": "../../..", "features": ["navigation.expand", "toc.follow", "navigation.top", "search.suggest", "navigation.footer", "navigation.tabs", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "content.code.copy", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script><script src=../../../assets/javascripts/bundle.aecac24b.min.js></script><script src=../../../js/timeago.min.js></script><script src=../../../js/timeago_mkdocs_material.js></script><script src=../../../javascripts/katex.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js></script><script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script>